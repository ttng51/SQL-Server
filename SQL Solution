** Occupations Problem **
With tab1 as (select 
       CASE WHEN Occupation = 'Doctor' then Name else NULL end as [Doctor],
       CASE WHEN Occupation = 'Professor' then Name else NULL end as [Professor],
       CASE WHEN Occupation = 'Singer' then Name else NULL end as [Singer],
       CASE WHEN Occupation = 'Actor' then Name else NULL end as [Actor]
from OCCUPATIONS),

NumberedRows as (
    Select 'Doctor' as OcType, Doctor as Occ, ROW_NUMBER() over (Order by Doctor asc) as rn       FROM tab1 
        where Doctor is not null
    UNION ALL
    Select 'Professor'as OcType, [Professor] as Occ,ROW_NUMBER() over (order by [Professor] asc )
      FROM tab1
        where Professor is not null
        UNION ALL
    Select 'Singer' as OcType, [Singer] as Occ,ROW_NUMBER() over (order by [Singer] asc)
      FROM tab1
        where [Singer] is not null
            UNION ALL
    Select 'Actor' as OcType, [Actor] as Occ,ROW_NUMBER() over (order by [Actor] asc)
      FROM tab1
        where [Actor] is not null

)
select
 MAX(CASE WHEN OcType = 'Doctor' THEN Occ END) AS Doc,
    MAX(CASE WHEN OcType = 'Professor' THEN Occ END) AS Pro,
    MAX(CASE WHEN OcType = 'Singer' THEN Occ END) AS Sing,
    MAX(CASE WHEN OcType = 'Actor' THEN Occ END) AS Act
FROM NumberedRows
GROUP BY rn
ORDER BY rn;

** Symmetric pairs
WITH tab1 AS (
  SELECT *, ROW_NUMBER() OVER (ORDER BY X, Y) AS rn
  FROM Functions
)
SELECT A.X AS X1, A.Y AS Y1
FROM tab1 AS A
JOIN tab1 AS B ON A.X = B.Y AND A.Y = B.X
WHERE A.rn < B.rn AND A.X <= A.Y
ORDER BY A.X ASC;

*** Placements
With tab1 as (select a.ID, a.Name, c.Salary,b.ID as FriendID, d.Salary as FriendSalary
from Students a
left join Friends b
on a.ID = b.ID
left join Packages c
on a.ID = c.ID
left join Packages d
on b.Friend_ID = d.ID)
select Name
from tab1
where FriendSalary > Salary
order by FriendSalary asc

